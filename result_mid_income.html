<!DOCTYPE html>

<html lang="ko">
<head>
    <link rel="stylesheet" href="styles/theme-colors.css" />
    <link rel="stylesheet" href="styles/layout.css" />
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>TaxSonic | 중간 계산 결과</title>
<style>
html { overflow-y: scroll; scrollbar-gutter: stable; }

  
:root {
  --bg-main: var(--ts-color-07);
  --bg-surface: var(--ts-color-03);
  --primary: var(--ts-color-05);
  --primary-hover: var(--ts-color-21);

  --text-main: var(--ts-color-08);
  --text-sub: var(--ts-color-04);
  --text-muted: var(--ts-color-09);

  --border-soft: var(--ts-color-02);
  --radius-lg: 16px;
  --radius-md: 12px;
}

* { box-sizing: border-box; font-family: "Pretendard","Noto Sans KR",system-ui,sans-serif; }
body { margin:0; background:var(--bg-main); color:var(--text-main); line-height:1.6; }
a { color: inherit; text-decoration:none; }
.container { max-width: 960px; margin: 0 auto; padding: 0 20px; }
header { border-bottom: 1px solid var(--border-soft); background: var(--bg-main); position: sticky; top:0; z-index: 10; }
.header-inner { height: 72px; display:flex; justify-content:space-between; align-items:center; }
.logo { font-size: 22px; font-weight: 700; letter-spacing: 0.2px; }
nav a { margin-left: 18px; font-size: 14px; color: var(--text-sub); }
nav a.active { color: var(--text-main); font-weight: 600; }
main { padding: 56px 0 96px; }
.surface { background: var(--bg-surface); border: 1px solid var(--border-soft); border-radius: var(--radius-lg); padding: 28px; }
.grid { display:grid; gap: 20px; }
.grid-2 { grid-template-columns: 1fr; }
@media (min-width: 860px){ .grid-2{ grid-template-columns: 1fr 1fr; } }
.h1 { font-size: 34px; margin: 0 0 12px; }
.h2 { font-size: 26px; margin: 0 0 10px; }
.h3 { font-size: 18px; margin: 0 0 8px; }
.p { color: var(--text-sub); margin: 0 0 18px; font-size: 15px; }
.muted { color: var(--text-muted); font-size: 13px; }
.hr { height:1px; background: var(--border-soft); margin: 18px 0; }
.btn-primary { background: var(--ts-primary); color:var(--ts-color-01); border:none; padding: 12px 16px; border-radius: 12px; cursor:pointer; font-size: 15px; }
.btn-primary:hover { background: var(--primary-hover); }
.btn-ghost { background: transparent; border: 1px solid var(--border-soft); padding: 12px 16px; border-radius: 12px; cursor:pointer; color: var(--text-sub); font-size: 15px; }
.btn-danger { background:var(--ts-color-10); color:var(--ts-color-01); border:none; padding: 10px 14px; border-radius: 12px; cursor:pointer; font-size: 14px; }
.btn-danger:hover { filter: brightness(0.95); }
.btn-small { padding: 8px 10px; border-radius: 10px; font-size: 13px; }
.field { margin-bottom: 14px; }
label { display:block; font-size: 13px; color: var(--text-sub); margin-bottom: 6px; }
input, select, textarea { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--border-soft); font-size: 14px; background: var(--ts-color-01); }
textarea { min-height: 120px; resize: vertical; }
.badge { display:inline-block; font-size: 12px; padding: 4px 8px; border-radius: 999px; border: 1px solid var(--border-soft); color: var(--text-sub); background: var(--ts-color-01); }
.badge.green { border-color: rgba(127,159,133,0.35); color: var(--ts-color-11); }
.badge.red { border-color: rgba(212,106,106,0.35); color: var(--ts-color-06); }
.table { width: 100%; border-collapse: collapse; overflow: hidden; border-radius: 14px; }
.table th, .table td { border-bottom: 1px solid var(--border-soft); padding: 12px 10px; text-align: left; font-size: 14px; }
.table th { color: var(--text-sub); font-weight: 600; background: rgba(250,247,242,0.6); }
.table tr:last-child td { border-bottom: none; }
.kpi { display:flex; justify-content:space-between; align-items:flex-start; gap: 12px; padding: 18px; border: 1px solid var(--border-soft); border-radius: 16px; background: var(--bg-surface); }
.kpi .num { font-size: 26px; font-weight: 800; }
.kpi .label { color: var(--text-sub); font-size: 13px; }
.card { background: var(--bg-surface); border: 1px solid var(--border-soft); border-radius: var(--radius-lg); padding: 22px; }
.list { display:flex; flex-direction:column; gap: 12px; }
.list-item { background: var(--bg-surface); border: 1px solid var(--border-soft); border-radius: 14px; padding: 16px; display:flex; justify-content:space-between; gap: 12px; }
.list-item .meta { color: var(--text-muted); font-size: 12px; }
.tabs { display:flex; gap: 8px; flex-wrap:wrap; }
.tab { padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border-soft); background: var(--ts-color-01); color: var(--text-sub); font-size: 14px; cursor:pointer; }
.tab.active { background: var(--bg-surface); color: var(--text-main); font-weight: 600; }
.notice { border: 1px dashed var(--border-soft); border-radius: 14px; padding: 14px; color: var(--text-sub); background: rgba(250,247,242,0.6); }
.footer { border-top: 1px solid var(--border-soft); text-align:center; padding: 26px 0; font-size: 13px; color: var(--text-muted); }

  
  /* ===== Slide Drawer ===== */
#hamburgerBtn{
  position:fixed; left:8px; top:8px; z-index:10050;
  width:46px; height:46px;
  border-radius:14px;
  border:1px solid var(--border-soft, var(--ts-color-02));
  background:var(--ts-color-01);
  cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-size:18px; line-height:1;
  box-shadow:0 8px 22px rgba(0,0,0,.08);
}
#drawerBackdrop{
  position:fixed; inset:0; z-index:10040;
  background:rgba(0,0,0,.35);
  opacity:0; pointer-events:none;
  transition:opacity .18s ease;
}
#drawerBackdrop.open{ opacity:1; pointer-events:auto; }
#drawer{
  position:fixed; left:0; top:0; height:100%; width:320px; max-width:88vw;
  z-index:10060;
  background:var(--bg-surface, var(--ts-color-03));
  border-right:1px solid var(--border-soft, var(--ts-color-02));
  transform:translateX(-105%);
  transition:transform .22s ease;
  padding:18px;
  box-shadow: 10px 0 28px rgba(0,0,0,.10);

  overflow-y: auto;
  overscroll-behavior: contain;
  padding-bottom: 24px;
}
#drawer.open{ transform:translateX(0); }
.drawerHead{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:12px; }
.drawerTitle{ font-weight:800; }
.drawerClose{
  border:1px solid var(--border-soft, var(--ts-color-02)); background:var(--ts-color-01); border-radius:12px;
  padding:8px 10px; cursor:pointer;
}
.drawerNav{ display:flex; flex-direction:column; gap:14px; margin-top:8px; }
.drawerNav a{
  padding:10px 12px; border-radius:12px;
  border:1px solid var(--border-soft, var(--ts-color-02)); background:var(--ts-color-01);
  color:var(--text-sub, var(--ts-color-04)); font-size:14px;
  white-space:nowrap;
}
.drawerNav a:hover{ filter:brightness(.98); }
/* header space for fixed hamburger */
header .header-inner{ padding-left:64px; }


/* === v2 fine-tune: button text alignment === */
.btn-ghost, .btn-primary, .btn-outline, .btn, .drawerClose {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  white-space: nowrap;
}

/* v5: mid buttons */
.btn, .btnPrimary{display:inline-flex;align-items:center;justify-content:center;text-align:center;white-space:nowrap;}

/* v9: mid step buttons look like real buttons */
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:12px 16px;
  border-radius:12px;
  border:1px solid var(--border-soft);
  background:var(--ts-color-01);
  color:var(--text-main);
  font-size:15px;
  cursor:pointer;
}
.btn:hover{ filter:brightness(.98); }
.btnPrimary{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:12px 16px;
  border-radius:12px;
  border:1px solid rgba(30,58,138,0.35);
  background:var(--primary);
  color:var(--ts-color-01);
  font-size:15px;
  cursor:pointer;
}
.btnPrimary:hover{ background:var(--primary-hover); }



/* v8-fixed: docs help modal (rent/donation) */
.badge{display:inline-flex;align-items:center;justify-content:center;text-align:center;white-space:nowrap;}
.modalOverlay{position:fixed;inset:0;background:rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;padding:18px;z-index:60}
.modalOverlay.hidden{display:none}
.modalCard{width:min(520px,100%);background:var(--bg-surface);border:1px solid var(--border-soft);border-radius:18px;box-shadow:0 12px 30px rgba(0,0,0,.18);padding:14px}
.modalHeader{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}
.modalTitle{font-weight:900}
.modalBody{color:var(--text-sub);font-size:14px;line-height:1.6;white-space:pre-line}


/* v13: spacing between AI comment and next step */
.ai-next-spacer{height:24px}


/* v16: fixed bottom bar (keep export content) */
main{ padding-bottom: 220px; }
.bottomBar{
  position:fixed; left:0; right:0; bottom:0; z-index:50;
  background: rgba(245,241,235,.92);
  border-top:1px solid var(--border-soft);
  backdrop-filter: blur(6px);
}
.bottomBarInner{
  max-width: 960px;
  margin: 0 auto;
  padding: 12px 20px;
}
.bottomMerged{
  background: var(--bg-surface);
  border:1px solid var(--border-soft);
  border-radius: 16px;
  padding: 12px;
}
.bottomTitle{
  font-weight:800;
  font-size:13px;
  color: var(--text-sub);
}
.bottomBtns{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}

.bottomMergedRow{
  display:flex;
  gap:12px;
  align-items:flex-start;
}
.bottomMergedGroup{
  flex:1;
  display:flex;
  flex-direction:column;
  gap:10px;
  min-width:0;
}
.bottomMergedGroupRight{ max-width: 320px; }
.bottomMergedDivider{
  width:1px;
  align-self:stretch;
  background: var(--border-soft);
  border-radius: 1px;
}
.bottomTitleRight{ text-align:right; }
.bottomBtnsRight{ justify-content:flex-end; }
@media (max-width: 860px){
  main{ padding-bottom: 280px; }
  .bottomMergedRow{ flex-direction:column; }
  .bottomMergedGroupRight{ max-width:none; }
  .bottomTitleRight{ text-align:left; }
  .bottomBtnsRight{ justify-content:flex-start; }
  .bottomMergedDivider{ display:none; }
}



/* v17: bottom bar button size (match v15) */
.bottomBar .btn-primary,
.bottomBar .btn-ghost,
.bottomBar .btn-danger,
.bottomBar a.btn-ghost,
.bottomBar a.btn-primary{
  padding: 8px 10px;
  border-radius: 10px;
  font-size: 13px;
}
.bottomBar .btn-small{ padding: 8px 10px; border-radius: 10px; font-size: 13px; }



/* v18: bottom bar export button sizing (match v15) */
.bottomBar .bottomMergedGroup .grid{
  display:flex !important;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
}
.bottomBar .bottomMergedGroup .grid > *{
  width:auto !important;
  max-width:none !important;
}
.bottomBar .bottomMergedGroup button,
.bottomBar .bottomMergedGroup a{
  padding:12px 16px !important;
  border-radius:12px !important;
  font-size:15px !important;
  line-height:1.1 !important;
}

/* drawer grouping */
.drawerGroup{ padding: 8px 0; }
.drawerGroup + .drawerGroup{ border-top: 1px solid rgba(255,255,255,0.14); }
.drawerGroupTitle{
  font-weight: 800;
  font-size: 12px;
  letter-spacing: 0.2px;
  opacity: 0.85;
  padding: 0 4px;
  margin: 4px 0 8px;
}
.drawerNav a{ display:block; }


/* ===== Drawer: active + accordion + admin ===== */
#drawer .drawerNav a.active{ outline:0; border:1px solid rgba(255,255,255,0.42); background: rgba(255,255,255,0.18); }
#drawer .drawerGroupTitle{ cursor:pointer; display:flex; align-items:center; justify-content:space-between; }
#drawer .drawerGroupTitle::after{ content:'▾'; opacity:0.8; font-size:12px; transform: rotate(0deg); transition: transform .18s ease; }
#drawer .drawerGroup.is-collapsed .drawerGroupTitle::after{ transform: rotate(-90deg); }
#drawer .drawerGroup.is-collapsed a{ display:none; }
#drawer .drawerAdminToggle{ display:flex; align-items:center; gap:8px; font-size:12px; opacity:.9; }
#drawer .drawerAdminToggle input{ width:16px; height:16px; }


/* v16 menu overrides */
/* 메뉴 버튼 간격/테두리/선택표시(굵기) */
#drawer .drawerNav a{ 
  position: relative;
  border: 1px solid var(--border-soft, var(--ts-color-02));
  background: var(--ts-color-01);
  outline: none !important;
  box-shadow: none !important;
  margin: 0;
}
#drawer .drawerNav a:hover{ filter: brightness(.98); }
#drawer .drawerNav a:focus{ outline: none !important; }
#drawer .drawerNav a.active{
  font-weight: 800;
  border: 1px solid var(--border-soft, var(--ts-color-02)) !important;
  background: var(--ts-color-01) !important;
  padding-left: 12px !important;
  box-shadow: none !important;
}
/* 그룹 타이틀을 버튼처럼 (아코디언 클릭 영역 확대) */

/* 펼친 그룹 내부 버튼 간격(요청 반영) */
#drawer .drawerGroup:not(.is-collapsed) a + a{ margin-top:10px; }

/* 그룹 타이틀(펼치기 전) 간격 원복 */
#drawer .drawerGroupTitle{
  cursor:pointer;
  padding: 0 4px;
  margin: 4px 0 8px;
  border-radius: 0;
  user-select: none;
  background: transparent;
}
</style>


<style id="taxsonic-theme">
:root{
  --ts-primary:var(--ts-color-05); /* Deep Blue */
  --ts-accent:var(--ts-color-05);  /* Mint */
  --ts-bg:var(--ts-color-12);
  --ts-card:var(--ts-color-01);
  --ts-border:var(--ts-color-13);
  --ts-text:var(--ts-color-14);
  --ts-text-sub:var(--ts-color-15);
}

/* Base */
html,body{background:var(--ts-bg);}
body{color:var(--ts-text);}

/* Links */
a{color:inherit;}
a:hover{color:var(--ts-primary);}

/* Primary CTA buttons (broad but safe) */
.btn-primary,
.button-primary,
a.btn-primary,
button.btn-primary,
button.primary,
a.primary,
.primary-btn,
.cta,
.cta-btn{
  background:var(--ts-primary) !important;
  color:var(--ts-color-01) !important;
  border:1px solid rgba(30,58,138,.25) !important;
  font-weight:600 !important;
}
.btn-primary:hover,
.button-primary:hover,
a.btn-primary:hover,
button.btn-primary:hover,
button.primary:hover,
a.primary:hover,
.primary-btn:hover,
.cta:hover,
.cta-btn:hover{
  filter:brightness(.95);
}

/* Secondary/accent highlights (badges, small emphasis) */
.badge-accent,
.tag-accent,
.pill-accent{
  background:rgba(45,212,191,.18) !important;
  color:var(--ts-primary) !important;
  border:1px solid rgba(45,212,191,.35) !important;
}

/* Active menu item: bold + deep blue (no dot) */
a.active,
nav a.active,
.menu a.active,
.drawer a.active,
#drawer a.active{
  color:var(--ts-primary) !important;
  font-weight:700 !important;
}

/* Section title accent bar (if used) */
.section-title::before,
.sectionTitle::before,
.title-bar::before{
  background:var(--ts-primary) !important;
}

/* Key result amounts */
.result-amount,
.refund-amount,
.total-amount,
.amount-primary,
.highlight-amount{
  color:var(--ts-primary) !important;
  font-weight:800 !important;
}

/* Chart bars / analysis visuals */
.chart-bar.main,
.chartBar.main,
.graph-bar.main,
.bar.main{
  background:var(--ts-accent) !important;
}
.chart-bar,
.chartBar,
.graph-bar,
.bar{
  background:rgba(30,58,138,.18);
}

/* Focus ring accessibility without ugly outlines */
:focus{outline:none;}
:focus-visible{
  outline:2px solid rgba(45,212,191,.55);
  outline-offset:2px;
  border-radius:10px;
}

/* TaxSonic analysis bars used in MyPage/Results */
.barTrack{ background: rgba(30,58,138,.14) !important; }
.barFill{ background: var(--ts-accent) !important; }
.bottomBarInner{ background: var(--ts-accent) !important; }
.miniBars .bottomBarInner{ background: rgba(45,212,191,.8) !important; }
</style>

<style>
  body {
    background-color: var(--ts-color-19) !important;
  }
</style>

<style>
  /* ✅ 고정바 높이만큼 자동으로 본문에 여백 확보 */
  :root{
    --ts-bottom-bar-h: 240px; /* 초기값(JS가 실제 높이로 덮어씀) */
  }

  main{
    /* 기존 main padding-bottom(220/240/280px)을 이게 덮어쓰도록 !important */
    padding-bottom: calc(var(--ts-bottom-bar-h) + 24px) !important;
  }

  /* iPhone 같은 safe-area(하단 홈바) 대응 */
  .bottomBar{
    padding-bottom: env(safe-area-inset-bottom);
  }
</style>

</head>
<body>
<!-- Slide Menu -->
<button aria-label="메뉴 열기" id="hamburgerBtn" type="button">☰</button>
<div aria-hidden="true" id="drawerBackdrop"></div>
<aside aria-label="슬라이드 메뉴" id="drawer">
<div class="drawerHead">
<div class="drawerTitle">메뉴</div>
<button class="drawerClose" id="drawerClose" type="button">닫기</button>
</div>
<div class="drawerNav">
    <div class="drawerGroup">
      <div class="drawerGroupTitle">기본</div>
      <a href="service_main.html">메인</a>
      <a href="onboarding.html">이용 가이드</a>
      <a href="login.html">로그인</a>
    </div>

    <div class="drawerGroup">
      <div class="drawerGroupTitle">계산</div>
      <a href="quick_calc.html">간편 계산</a>
      <a href="detail_income.html">상세 계산</a>
    </div>

    <div class="drawerGroup">
      <div class="drawerGroupTitle">고객센터</div>
      <a href="board_qna.html">Q&A</a>
      <a href="board_faq.html">FAQ</a>
    </div>

    <div class="drawerGroup" data-user-only="true">
      <div class="drawerGroupTitle">내 정보</div>
      <a href="mypage.html">마이페이지</a>
      <a href="member_history.html">기록 열람</a>
    </div>

    <div class="drawerGroup" data-admin-only="true">
      <div class="drawerGroupTitle">관리자</div>
      <a href="admin_tax_rates.html">세율/정책</a>
      <a href="admin_deduction_items.html">공제 항목</a>
      <a href="admin_analytics.html">로그 분석</a>
    </div>
  </div>
</aside>
<header>
<div class="container header-inner">
<div class="logo"><a href="service_main.html">TaxSonic</a></div>
<nav>
<a class="" href="onboarding.html">이용 가이드</a>
<a class="" href="quick_calc.html">간편 계산</a>
<a class="active" href="detail_income.html">상세 계산</a>
<a class="" href="board_qna.html">Q&amp;A</a>
<a class="" href="board_faq.html">FAQ</a>
<a class="" href="login.html">로그인</a>
</nav>
</div>
</header>
<main class="container">
<div class="h1">중간 계산 결과</div>
<p class="p">소득공제 입력 내용만 반영한 중간 결과를 확인합니다.</p>
<div class="grid grid-2">
<div class="card">
<div class="h3">소득공제 기준 예상 결과(데모)</div>
<div class="result-amount" style="font-size:36px;font-weight:900;margin:8px 0">+ 180,000원</div>
<div class="muted">※ 소득공제만 반영한 예시입니다.</div>
<div class="hr"></div>
<div class="h3">AI 참고 코멘트(데모)</div><ul style="margin:10px 0 0 18px;color:var(--sub);font-size:14px">
<li>세액공제 항목을 입력하면 결과가 더 정확해질 수 있어요.</li>
<li>모르는 항목은 각 입력란의 도움말 버튼을 눌러 확인하세요.</li>
</ul><div class="ai-next-spacer"></div>
</div>
<div class="card"><div class="surface">
<div class="h3">분석 그래프(예시)</div>
<div class="muted" style="margin-bottom:10px;">항목별 공제/감면 기여도를 막대로 표시합니다.</div>
<div style="display:grid; gap:10px;">
<div><div class="muted">소득공제</div><div style="height:12px; background: var(--ts-color-01); border:1px solid var(--border-soft); border-radius:999px; overflow:hidden;"><div style="height:100%; width:55%; background: var(--ts-primary);"></div></div></div>
<div><div class="muted">세액공제</div><div style="height:12px; background: var(--ts-color-01); border:1px solid var(--border-soft); border-radius:999px; overflow:hidden;"><div style="height:100%; width:35%; background: var(--ts-primary);"></div></div></div>
<div><div class="muted">감면</div><div style="height:12px; background: var(--ts-color-01); border:1px solid var(--border-soft); border-radius:999px; overflow:hidden;"><div style="height:100%; width:20%; background: var(--ts-primary);"></div></div></div>
</div>
</div><div class="surface">
<div class="muted">월세/기부금 항목별로 필요한 서류를 확인하세요.</div><div class="h3">필요 서류 안내</div>
<div class="list">
<div class="list-item" style="align-items:center">
<div>
<div style="font-weight:700;">월세</div>
<div class="meta">임대차계약서, 계좌이체 내역</div>
</div>
<button class="badge" onclick="openDocHelp('rent')" type="button">서류</button>
</div>
<div class="list-item" style="align-items:center">
<div>
<div style="font-weight:700;">기부금</div>
<div class="meta">기부금 영수증(기관 발급)</div>
</div>
<button class="badge" onclick="openDocHelp('donation')" type="button">서류</button></div>
</div>
</div></div>
</div>
</main>
<div id="emailModal" style="display:none; position:fixed; inset:0; background: rgba(0,0,0,0.35); align-items:center; justify-content:center; z-index: 1000;">
<div class="surface" style="max-width:520px; width: 92%;">
<div class="h3">결과 이메일 전송</div>
<p class="p">비로그인 사용자도 이메일 전송이 가능합니다.</p>
<div class="field">
<label>받는 이메일</label>
<input placeholder="name@example.com" type="email"/>
</div>
<div class="field">
<label>전송 내용</label>
<select>
<option>요약 텍스트 + 링크</option>
<option>PDF 첨부 + 링크</option>
</select>
</div>
<div style="display:flex; justify-content:flex-end; gap:10px;">
<button class="btn-ghost" onclick="closeEmail()">취소</button>
<button class="btn-primary" onclick="alert('전송 요청(데모)'); closeEmail();">전송</button>
</div>
</div>
</div>
<script>
function openEmail(){ document.getElementById('emailModal').style.display='flex'; }
function closeEmail(){ document.getElementById('emailModal').style.display='none'; }
</script>
<div aria-label="하단 고정바" class="bottomBar" role="region">
<div class="bottomBarInner">
<div class="bottomMerged">
<div class="bottomMergedRow">
<div class="bottomMergedGroup">
<div class="bottomTitle">내보내기</div>
<div class="grid" style="gap: 10px;">
<button class="btn-ghost" onclick="alert('PDF를 생성합니다(데모).')" type="button">PDF 다운로드</button>
<button class="btn-primary" onclick="openEmail()" type="button">이메일로 보내기</button>
<a class="btn-ghost" href="member_history.html">회원 기록(예시 링크)</a>
</div>
</div>
<div aria-hidden="true" class="bottomMergedDivider"></div>
<div class="bottomMergedGroup bottomMergedGroupRight">
<div class="bottomTitle bottomTitleRight">다음 단계 선택</div>
<div class="bottomBtns bottomBtnsRight">
<a class="btn" href="result_final.html">여기서 끝내기</a>
<a class="btn btnPrimary" href="detail_taxcredit.html">세액공제로 진행</a>
</div>
</div>
</div>
</div>
</div>
</div>
<footer class="footer">© 2026 TaxSonic. All rights reserved.</footer>
<script>
(function(){
  const btn = document.getElementById('hamburgerBtn');
  const drawer = document.getElementById('drawer');
  const backdrop = document.getElementById('drawerBackdrop');
  const closeBtn = document.getElementById('drawerClose');

  function open(){
    drawer && drawer.classList.add('open');
    backdrop && backdrop.classList.add('open');
  }
  function close(){
    drawer && drawer.classList.remove('open');
    backdrop && backdrop.classList.remove('open');
  }
  btn && btn.addEventListener('click', open);
  closeBtn && closeBtn.addEventListener('click', close);
  backdrop && backdrop.addEventListener('click', close);
  // ===== Active highlight (drawer + header nav) =====
  const current = (location.pathname.split('/').pop() || 'index.html').split('?')[0].split('#')[0];
  const allLinks = document.querySelectorAll('#drawer .drawerNav a');
  allLinks.forEach(a => {
    const href = (a.getAttribute('href') || '').trim();
    if(href && href === current){ a.classList.add('active'); }
  });
  const topNavLinks = document.querySelectorAll('header nav a');
  topNavLinks.forEach(a => {
    const href = (a.getAttribute('href') || '').trim();
    if(href && href === current){ a.classList.add('active'); }
  });

    // ===== Admin visibility (role-based, no toggle) =====
  function getUserRole(){
    const role = localStorage.getItem('taxsonic_user_role')
      || localStorage.getItem('taxsonic_role')
      || localStorage.getItem('role')
      || '';
    return String(role).toLowerCase();
  }
  function isLoggedIn(){
    const v = localStorage.getItem('taxsonic_is_logged_in')
      || localStorage.getItem('taxsonic_logged_in')
      || localStorage.getItem('is_logged_in')
      || '';
    const hasToken = !!(localStorage.getItem('taxsonic_token') || localStorage.getItem('auth_token') || localStorage.getItem('access_token'));
    const hasUser = !!(localStorage.getItem('taxsonic_user_id') || localStorage.getItem('user_id') || localStorage.getItem('username'));
    // If role is set, treat as logged-in for this static prototype.
    const role = getUserRole();
    return v === '1' || v === 'true' || hasToken || hasUser || role === 'admin' || role === 'user';
  }
  function getIsAdmin(){
    const role = getUserRole();
    const legacy = (localStorage.getItem('taxsonic_is_admin') === '1'); // backward compat for older builds
    return role === 'admin' || legacy;
  }
  function applyAdminVisibility(){
    const showAdmin = isLoggedIn() && getIsAdmin();
    document.querySelectorAll('[data-admin-only="true"]').forEach(el => {
      el.style.display = showAdmin ? '' : 'none';
    });
  }
  applyAdminVisibility();

// ===== Accordion groups =====
  function setCollapsed(group, collapsed){
    if(!group) return;
    group.classList.toggle('is-collapsed', !!collapsed);
    const title = group.querySelector('.drawerGroupTitle');
    if(title){
      title.setAttribute('aria-expanded', collapsed ? 'false' : 'true');
    }
  }

  const groups = Array.from(document.querySelectorAll('#drawer .drawerGroup'));
  groups.forEach(group => {
    const title = group.querySelector('.drawerGroupTitle');
    if(!title) return;

    const name = title.textContent.trim();
    const key = 'taxsonic_drawer_group_' + name;

    // make title behave like a button
    title.setAttribute('role','button');
    title.setAttribute('tabindex','0');

    const saved = localStorage.getItem(key);
    if(saved === '1') setCollapsed(group, true);

    const toggle = () => {
      const collapsed = group.classList.contains('is-collapsed');
      const next = !collapsed
      setCollapsed(group, next);
      localStorage.setItem(key, next ? '1' : '0');
    };

    title.addEventListener('click', toggle);
    title.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        toggle();
      }
    });
  });

  // Ensure active link's group is open
  const active = document.querySelector('#drawer .drawerNav a.active');
  if(active){
    const group = active.closest('.drawerGroup');
    if(group){
      setCollapsed(group, false);
      const title = group.querySelector('.drawerGroupTitle');
      if(title){
        const key = 'taxsonic_drawer_group_' + title.textContent.trim();
        localStorage.setItem(key, '0');
      }
    }
  }
})();
</script>
<div aria-modal="true" class="modalOverlay hidden" id="docHelp" role="dialog">
<div class="modalCard">
<div class="modalHeader">
<div class="modalTitle" id="docHelpTitle">서류 안내</div>
<button class="btn-ghost btn-small" onclick="closeDocHelp()" type="button">닫기</button>
</div>
<div class="modalBody" id="docHelpBody"></div>
</div>
</div><script>
function openDocHelp(type){
  const map = {
    rent: {
      title: "월세 서류 안내",
      body: "- 임대차계약서 사본\n- 월세 이체/납부 내역(계좌이체/현금영수증 등)\n- 주민등록등본(필요 시)\n- (참고) 계약자/납부자/주소가 다르면 추가 증빙이 필요할 수 있어요"
    },
    donation: {
      title: "기부금 서류 안내",
      body: "- 기부금 영수증(기부기관 발급)\n- (참고) 기부금 유형(정치/법정/지정 등)에 따라 한도/공제 방식이 달라질 수 있어요\n- 기관 홈페이지/홈택스에서 발급 가능한 경우도 있어요"
    },
    general: {
      title: "서류 안내",
      body: "항목을 선택하세요."
    }
  };
  const data = map[type] || map.general;
  document.getElementById("docHelpTitle").textContent = data.title;
  document.getElementById("docHelpBody").textContent = data.body;
  document.getElementById("docHelp").classList.remove("hidden");
}
function closeDocHelp(){
  document.getElementById("docHelp").classList.add("hidden");
}
</script>
<script>
(function(){
  function isLoggedIn(){
    return (localStorage.getItem('taxsonic_is_logged_in') === '1');
  }
  function clearAuth(){
    localStorage.removeItem('taxsonic_is_logged_in');
    localStorage.removeItem('taxsonic_user_role');
    localStorage.removeItem('taxsonic_role');
    localStorage.removeItem('role');
    localStorage.removeItem('taxsonic_is_admin'); // legacy
  }

  function enhanceLoginLogoutLinks(){
    const links = Array.from(document.querySelectorAll('a[href="login.html"], a[href="./login.html"]'));
    if(!links.length) return;

    if(isLoggedIn()){
      links.forEach(a=>{
        a.setAttribute('href', '#logout');
        a.textContent = '로그아웃';
        a.classList.add('logoutLink');
      });
      document.addEventListener('click', function(e){
        const a = e.target.closest('a[href="#logout"]');
        if(!a) return;
        e.preventDefault();
        clearAuth();
        window.location.href = 'index.html';
      });
    } else {
      links.forEach(a=>{
        a.textContent = '로그인';
        // keep href as login.html
      });
    }
  }

  document.addEventListener('DOMContentLoaded', enhanceLoginLogoutLinks);
})();
</script>
</body>
</html>
